<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="description" content="单词学习">
    <meta name="keywords" content="单词学习 练习">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>英语 培训 单词学习</title>
    <link rel="stylesheet" crossorigin="anonymous"
        href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.1/css/bootstrap.min.css">
    <link rel="stylesheet" crossorigin="anonymous"
        href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.1/animate.min.css">


    <style>
        .glassbga {
            /*渐变*/
            background: linear-gradient(to right bottom, rgba(255, 255, 255, 0.7), rgba(255, 255, 255, 0.2));
            ;
            border-radius: 1rem;
            box-shadow: 6px 6px 10px rgba(112, 112, 112, 0.2);
        }

        .glassbg {
            background: linear-gradient(to right top, #65dfc9, #9ec7ce);
            border-radius: 1rem;
        }

        .circle-ab {
            background: linear-gradient(to right bottom, rgba(255, 255, 255, 0.7), rgba(255, 255, 255, 0.2));
            height: 14rem;
            width: 14rem;
            position: absolute;
            border-radius: 50%;
            opacity: 0.3;
        }

        .circle1 {
            top: 0%;
            right: 13%;
        }

        .circle2 {
            bottom: 6%;
            left: 13%;
        }

        .center {
            position: absolute;
            left: 50%;
            top: 10%;
            transform: translate(-50%, -50%);
        }
    </style>
</head>
<!--
     swiper 展示
-->

<body id="q-app" class=" glassbg text-white  ">
    <!--悬浮球-->
    <div class="circle1 circle-ab"> </div>
    <div class="circle2 circle-ab"></div>
    <div class="  fixed-top ">



    </div><!---上面的结果框val--->
    <div class="container ">
       
        <!--选题列表-->
        <div class="  row     justify-content-center     ">
            <div class="w-100 mt-5   d-none d-md-block"><!---高度垫子 小设备隐藏--></div>

            <div class=" row  col-md-10 col-sm-12 flex-wrap    bg-warning glassbga    ">
                <span v-for="(site, index) in pd.wordLs"
                    :class="[{'text-warning': (index+1  == pd.page )}, {' text-center': (index  != pd.page )}]"
                    class="btn  col-1 badge   badge-secondary mx-1  px-1 my-1"
                    @click="er.emit('跳转',index+1) ">{{index+1}}</span>
            </div>

        </div>

    </div>
    <div class="container ">
        <div class="mt-2 row justify-content-center  ">
            <div class="w-100 mb-3   d-none d-md-block"><!---高度垫子 小设备隐藏--></div>
            <div  >
                <h4>选择对应的英文单词</h4>
            </div>
           
        </div>
    </div>
    <!--卡片-->
    <div class=" container-md   glassbga  pt-md-5  pb-md-5 pt-sm-1  pb-sm-1">

        <div class=" row   align-items-center   justify-content-around   ">

            <img onload="er.emit('进度',30) " v-bind:src="pd.row.img" style="max-width:100%;overflow:hidden;"
                class="img-fluid" alt="...">

        </div>
        <div class=" row   align-items-center   justify-content-around" style="height: 80px;">

            <button @click="er.emit('播放',0) "
                class="btn ml-sm-5 mx-sm-2   px-sm-5 shadow  badge-secondary badge   badge-pill">
                <h3 class="text-nowrap"> {{pd.row.zh || 中文}} </h3>
            </button>
            <button @click="er.emit('播放',1) "
                class="btn mr-sm-5 mx-sm-2   px-sm-5    shadow   badge-info badge   badge-pill">
                <h3 class="text-nowrap">{{pd.row.en || 英文}} </h3>
            </button>
        </div>
        <!---nan-->
        <div class=" d-flex    align-items-center  justify-content-around " style="height: 80px;">

            <span class="  w-50  ml-sm-5 mx-sm-2     shadow   badge-info   badge badge-pill">
                <audio onloadeddata="er.emit('进度',31) " class="  w-100   " controls="controls" v-bind:src="pd.row.zh4m">
                    Your browser does not support the audio element.
                </audio>
            </span>
            <span class="  w-50    mr-sm-5 mx-sm-2     shadow   badge-info badge   badge-pill">
                <audio onloadeddata="er.emit('进度',32) " class="  w-100   " controls="controls" v-bind:src="pd.row.en4m">
                    Your browser does not support the audio element.
                </audio>
            </span>
        </div>

    </div>
    <!--选择单词区-->
    <div id="toChange" class="     container-md    glassbga  mt-sm-4  mb-sm-4  mt-1  mb-1  pt-3  pb-3">
        <div class=" row  align-items-center  justify-items-around">
            <button @click="er.emit('播放',0) "
                class="btn ml-sm-2 mx-sm-1   px-sm-2 shadow  badge-secondary badge   badge-pill">
                <h3 class="flex-wrap"> {{pd.row.zh || 中文}} </h3>
            </button>
            <button @click="er.emit('播放',1) "
                class="btn col-1 mr-sm-2 mx-sm-2   px-sm-2    shadow   badge-info badge   badge-pill">
                <h3 class="flex-wrap">{{pd.row.en || 英文}} </h3>
            </button>


        </div>

    </div>
    <div class=" container">
        <p>从下面的单词中选择你认为正确的，然后✔</p>
    </div>

    <!--功能选择--->
    <div class="fixed-bottom row justify-content-center rounded   ">
        <div class="mt-2 row justify-content-center  ">
            <div class="w-100 mb-5   d-none d-md-block"><!---高度垫子 小设备隐藏--></div>
            <div class="container   ">
                <ul class="nav nav-tabs">
                    <li class="nav-item">
                        <a class="nav-link shadow  bg-secondary   text-white  px-lg-5 mx-md-2 mx-lg-5   "
                            href="./learnword.html">学一学</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link shadow  bg-info text-white  px-lg-5 mx-md-2 mx-lg-5 active"
                            href="./pracword.html">练一练</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link shadow   bg-secondary  text-white  px-lg-5 mx-md-2 mx-lg-5" href="#">试一试</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>


    <!---info提示信息--->
    <transition mode="out-in" enter-active-class="animated pulse" leave-active-class="animated fadeOut">
        <div class=" container-sm  fixed-top    " style="z-index: 1083 ;" v-for="site in pd.info_list">
            <div class="alert  alert-warning alert-dismissible fade show" role="alert">
                <strong>{{site.type}}</strong>{{ site.info }}
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
        </div>
    </transition>
 
 
    <!---载入动画--->
    <transition leave-active-class="animated fadeOut">
        <div v-if="pd.sp==0?false:true"
            class="center w-100 mt-5  px-3  row d-flex  clearfix  align-items-center  justify-content-center  "
            style="z-index: 1082  ;">
            <div class="spinner-border   "></div>
        </div>
    </transition>
    <!---进度条---->
    <transition   enter-active-class="animated fadeIn" leave-active-class="animated fadeOut">
        <div v-if="pd.showProgress" class="center w-75   px-3   " style="z-index: 1082 ; ">
            <div class="progress">
                <div class=" progress-bar  progress-bar-striped progress-bar-animated  "
                    v-bind:style="{ width: pd.vprogress+'%' , }">{{pd.vprogress}}%</div>
            </div>
        </div>
    </transition>
    <!---遮罩1024--->
   
        <div v-if="pd.showLoading" @click="er.emit('遮罩',0) " style="z-index: 1081  ;"
            class=" modal-backdrop show "> </div>

    
    <!---侧边栏 -->
    <nav v-if="pd.showNav " class="  d-flex  navbar-light bg-light"
        style="z-index:1082; top:0;left:0;width: 240px; height: 100vh; position: fixed;">
        <ul >
            <li class="nav-item ">
                <a class="nav-link" href="#">目录  </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">第二课</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">第三课</a>
            </li>
            <li class="nav-item">
                <a class="nav-link  " href="#">第四课</a>
            </li>
        </ul>
    </nav>
    <div class=" d-flex w-25  fixed-bottom justify-content-between  ">
        <!-- 齿轮修改 --->
        <span @click="er.emit('导航',1) " class="  d-none  btn     justify-content-end      "
            style="font-size:28px;    ">⚙</span>
        <button @click="er.emit('导航',1) " class="navbar-light  navbar-toggler">
            <span class="navbar-toggler-icon"></span>
        </button>
    </div>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.2.47/vue.global.prod.min.js"></script>
    <!--script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/2.4.2/lodash.min.js"></script--->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/EventEmitter/5.2.8/EventEmitter.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.19.11/URI.min.js"></script>


    <!--script type="text/javascript" onload="console.log(10000)" onerror="console.log(55555)" src="https://disk.17121.top/camb_word/6/5/365/cfg_365.json"></script-->

    <script>
        const er = new EventEmitter //事件线
        const { onMounted, emits, createApp, ref, watch, computed } = Vue

        const gd = {};//全局数据 解决调用引用问题
        gd.storage = {
            //本地浏览器 存取组件
            set(key, value) {
                localStorage.setItem(key, JSON.stringify(value));
            },
            get(key) {
                return JSON.parse(localStorage.getItem(key));
            },
            remove(key) {
                localStorage.removeItem(key);
            },
        }
        gd.pd = ref({ "load": [] });;//page data 页面元素引用"数据"
        //const pd = ref({ "load": [] }); //特殊变量，页面数据
        const pvs = gd.pd.value; //变量代理访问
        //gd.pd = pd;//page data 页面元素引用"数据"

        class pgui {
            /* 界面控制类 初始化界面默认值 */
            constructor(arg) {
             
                pvs.load.unshift('pgui')//从开头添加一个值
                pvs.sp = 0; //遮罩路由 (0.无，1.名单，2.登入 ,3.管理)
                pvs.row = {};//单词数据的一行
                pvs.showNav = 0;//导航显示
                pvs.showLoading = 0 //遮罩
                pvs.total = 0
                pvs.page = gd.storage.get('page') ? gd.storage.get('page') : 1;//显示动画

                pvs.info_list = []//{info:"2",type:"2"}

                pvs.vprogress = 100 //进度条
                pvs.wordLs = []
                //this.initManage();
                //绑定事件
                //er.on("读取.单词", this.getRow)
                //er.on('收到.单词', this.signing)
                this.init();
            }
            init() {
                //初始（设置）

                er.on('遮罩', this.loginLoading)
                er.on('播放', this.play)
                er.on('翻页', this.nextPage)
                er.on('跳转', this.toPage)
                er.on('进度', this.progress)
                er.on('导航',this.trunNav)
            }
            trunNav(n){
                const that = gd.oui
                pvs.showNav=n
                pvs.showLoading = n
            }

            loadJson() {
                //一次性加载 json数据  默认数据来源当前站点，当前没有访问主站

                const that = gd.oui
                //document.getElementById('dataFromJson').remove ()
                // delete  dataFromJSON .data
                // 添加数据json元素

                var st = document.createElement("script");
                st.id = 'dataFromJson';
                st.src = 'https://disk.17121.top/camb_word/6/5/365/cfg_365.json';
                // 'https://p_disk.17121.top/camb_word/6/5/365/cfg_365.json'; //经过代理
                st.onerror = that.signErr;
                st.onload = that.signing;
                //console.log(dataFromJSON)
                document.body.appendChild(st);
                console.log("添加script标签=", pvs.page)
                //词展示++++
                that.loginLoading(1) //loading 
                that.spto(1) //loading 



            }
			   getPage() {
                // 超限 问题处理
                var page = gd.storage.get('page') ? gd.storage.get('page') : 1;//默认值
                page = parseInt(page);
                if (page <= 0) { page = 1; }
                if (page > pvs.total) { page = pvs.total; }
                gd.storage.set('page', page);
                return page;

            }
            toPage(n) {
                const that = gd.oui
                //跳转到某页面
                pvs.page = parseInt(n);

                //---处理
                gd.storage.set('page', pvs.page)
                pvs.vprogress = 6

                //载入数据 
                that.signing(1)


            }
            nextPage(n) {
                //内部翻页
                const that = gd.oui



                //document.getElementById('dataFromJson').remove ()
                // delete  dataFromJSON .data
                //on mount 
                console.log('内部翻页', pvs.page, n)
                //限定page的范围
                pvs.page = parseInt(pvs.page) + n;
                console.log('内部翻页', pvs.page, n)
                if (pvs.page <= 0) { pvs.page = 1; that.showInfo("已经到头", '翻页'); return; }
                if (pvs.page > pvs.total) { pvs.page = pvs.total; that.showInfo("已经到头", '翻页'); return; }
                //---处理
                gd.storage.set('page', pvs.page)
                pvs.vprogress = 6


                //载入数据 
                that.signing(1)


            }
            play(n) {
                //播
                console.log('播放=', n)
                //播放指定 document.querySelectorAll('audio')[0].play()
                document.querySelectorAll('audio')[n].play()

            }


            loginLoading(n) {
                //登入中效果
                pvs.showLoading = n
                pvs.showNav = pvs.showLoading == 0 ? 0 : 1
            }
            spto(n) {
                //遮罩和二级界面
                /*切换界面*/
                pvs.sp = n

            }
            progress(n) {
                const that = gd.oui
                //进度  0 和 100 都隐藏
                
                pvs.vprogress = pvs.vprogress + n
                console.log("进度", n,pvs.vprogress)
                if (pvs.vprogress > 98) {
                    pvs.vprogress  = 100
                    setTimeout(function () { pvs.showProgress = 0 }, 50);
                    that.spto(0)
                    that.loginLoading(0)
                }else{
                    pvs.showProgress = 1
                }
            }

            showInfo(info, type = '') {
                //结果提示信息 （数据驱动）

                //添加数据，来添加提示

                pvs.info_list.push({ "info": info, "type": type })
                //缺少动效
                setTimeout(function () { pvs.info_list.splice(0, 1); }, 4000);



            }
            signErr(error) {
                //登入错误处理
                const that = gd.oui
                //pvs.login_info = "无法加载到数据，刷新重试"
                console.log('Error:', error); //提示框


                that.loginLoading(0) //loading 
                that.spto(0) //loading  
                that.showInfo('无法加载到数据，刷新重试', '载入数据：') //loading  


            }
            signing(dat) {
                // 读取数据到 json/翻页    页面
                console.log('dat==', dat)
                const that = gd.oui
                //词展示++++
                if (dat == 1) {
                    that.loginLoading(1) //内部翻页 
                    that.spto(1) //loading 
                } else {
                    that.loginLoading(1) //json加载 
                    that.spto(1) //loading 
                    pvs.vprogress = 6
                    pvs.total = dataFromJSON.data.length
                    pvs.wordLs = dataFromJSON.data
                }

                if (typeof (dataFromJSON) == "undefined" || dataFromJSON.data.length == 0) { that.showInfo("没找到数据", '翻页'); return; } //没数据

                if (pvs.page > pvs.total) { pvs.page = 1 }
                //设置数据
                console.log(dataFromJSON.src, pvs.page, dataFromJSON.data[pvs.page - 1])
                var row = dataFromJSON.data[pvs.page - 1]
                //pvs.row.img = '/en500word/h/e/健康.png' //  /en500word/h/e/健康.png
                pvs.row.img = dataFromJSON.src + row.img.substring(1) //  /en500word/h/e/健康.png
                //设置 mp3
                pvs.row.zh4m = dataFromJSON.src + row.cn4m2mp3.substring(1)
                pvs.row.en4m = dataFromJSON.src + row.en4m2mp3.substring(1)   //  
                pvs.row.zh = row.cn
                pvs.row.en = "????"
                //载入显示
                if (dat != 1) {
                    pvs.row.en = "????"
                    pvs.row.img = dataFromJSON.src + 'camb_word/choose.png'

                }

            }



            watchPg(newValue, oldValue) {
                //watch
                //console.log('gd pagedata 被修改', newValue.page, oldValue.page)


                //console.log('gd pagedata 被修改\n', newValue, '\n', oldValue)
            }
        }

        //----------开始
        let appdat = {
            setup() {

                const oui = new pgui(); //界面更改"方法"
                //const ocls = new cls(12);//默认选择
                //---放入全局解决this问题
                //gd.ocls = ocls; //抽奖类
                //gd.oin = oin; //通信逻辑
                gd.oui = oui; //ui界面


                watch(gd.pd, oui.watchPg, { deep: true });

                //computed(() => { return JSON.parse(JSON.stringify(pvs)); }); //对值二次计算
                //onMounted(() => ocls.bindEvt()); //窗口大小变动事件
                //onMounted(() => oui.remount()); //已经登入刷新处理
                onMounted(() => oui.loadJson(0)); //已经登入刷新处理
                //--变量关联到html的映射 js访问要加.value
                return { er, oui, "pd": gd.pd, "ref_login_manage": gd.pd.refManageEmt, }
            }
        }
        const app = createApp(appdat)
        //app.use(Quasar) //vue的ui
        app.mount('#q-app')
    </script>





</body>

</html>